resources:
  repositories:
  - repository: cv
    type: github
    endpoint: twistsmyth
    name: twistsmyth/cv
  - repository: space-invaders
    type: github
    endpoint: twistsmyth
    name: twistsmyth/space-invaders


trigger:
- main

pool:
  vmImage: ubuntu-latest

steps:
- checkout: self
- checkout: space-invaders

- task: Bash@3
  inputs:
    targetType: 'inline'
    script: |
      # scripted
      echo 'merge site'
      mv $(build.sourcesDirectory)/space-invaders/index.html $(build.sourcesDirectory)/space-invaders/space.html
      cp -r $(build.sourcesDirectory)/space-invaders/. $(build.sourcesDirectory)/cv/. $(Build.ArtifactStagingDirectory)

- task: UniversalPackages@0
  inputs:
    command: 'publish'
    publishDirectory: '$(Build.ArtifactStagingDirectory)'
    feedsToUsePublish: 'internal'
    vstsFeedPublish: '2deb107a-8cc7-4c49-82c5-da9958d9fd7b'
    vstsFeedPackagePublish: 'cv'
    versionOption: 'custom'
    versionPublish: '0.0.1'
    packagePublishDescription: 'Website'
    publishedPackageVar: 'cv'


